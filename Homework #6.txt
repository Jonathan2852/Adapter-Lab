--1.)
SELECT RECOMMENDEDBY, COUNT(*) AS COUNT
FROM MEMBERS
WHERE RECOMMENDEDBY IS NOT NULL
GROUP BY RECOMMENDEDBY
ORDER BY RECOMMENDEDBY;

--2.)
SELECT FACID, SUM(SLOTS) AS TOTAL_SLOTS
FROM BOOKINGS
GROUP BY FACID
HAVING SUM(SLOTS) > 1000
ORDER BY FACID;

--3.)
SELECT FACID, SUM(SLOTS) AS TOTAL_SLOTS
FROM BOOKINGS
GROUP BY FACID
HAVING SUM(SLOTS) = (
    SELECT MAX(S.SUM_SLOTS)
    FROM (
        SELECT SUM(SLOTS) AS SUM_SLOTS
        FROM BOOKINGS
        GROUP BY FACID
        ) AS S
);

--4.)
SELECT M.SURNAME, M.FIRSTNAME, M.MEMID, MIN(STARTTIME) AS STARTTIME
FROM MEMBERS AS M
    INNER JOIN BOOKINGS AS B on M.MEMID = B.MEMID
WHERE DATE(STARTTIME)  >= '2012-09-01'
GROUP BY M.SURNAME, M.FIRSTNAME, M.MEMID
ORDER BY M.MEMID;

--5.)
SELECT START_MONTH, START_YEAR, COUNT(*) AS TOTAL_BOOKINGS
FROM (
    SELECT MONTH(STARTTIME) AS START_MONTH, YEAR(STARTTIME) AS START_YEAR
    FROM BOOKINGS
     ) AS S
GROUP BY START_YEAR, START_MONTH
ORDER BY START_YEAR, START_MONTH;